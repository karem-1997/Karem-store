<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helmy Card - Final Ultimate</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        
        :root {
            --gold: #bf953f;
            --gold-grad: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7);
            --bg: #0c0c0c;
            --input-bg: #161616;
            --card-border: #2a2a2a;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            color: #fff; margin: 0; padding: 15px;
            display: flex; flex-direction: column; align-items: center;
        }

        /* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø§Ù„Ø«Ø§Ø¨Øª */
        .master-brand {
            font-size: 35px; font-weight: 900;
            background: var(--gold-grad);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin: 20px 0; text-align: center; letter-spacing: 2px;
        }

        .tabs-container {
            display: flex; gap: 12px; overflow-x: auto;
            width: 100%; max-width: 500px; padding: 10px 5px;
            margin-bottom: 15px;
        }

        .tab-btn {
            background: var(--input-bg); border: 1px solid var(--card-border);
            color: #aaa; padding: 12px 25px; border-radius: 30px;
            cursor: pointer; white-space: nowrap; transition: 0.3s; font-weight: bold;
        }

        .tab-btn.active {
            background: var(--gold-grad); color: #000; border: none;
            box-shadow: 0 5px 15px rgba(191,149,63,0.4);
        }

        .main-card {
            width: 100%; max-width: 480px;
            border: 2px solid var(--gold); border-radius: 35px;
            padding: 30px; background: #0e0e0e;
            display: none; box-shadow: 0 25px 50px rgba(0,0,0,0.8);
        }

        .app-name-ui {
            text-align: center; font-size: 24px; color: var(--gold);
            margin-bottom: 20px; font-weight: 900;
        }

        .withdraw-info {
            border: 1px dashed var(--gold); border-radius: 20px;
            padding: 20px; text-align: center; margin-bottom: 25px;
            background: rgba(191,149,63,0.03); cursor: pointer;
        }

        .input-group { margin-bottom: 22px; text-align: right; }
        .input-group label {
            display: block; color: var(--gold); font-size: 14px;
            margin-bottom: 10px; font-weight: bold; padding-right: 5px;
        }

        input, select {
            width: 100%; background: var(--input-bg); border: 1px solid var(--card-border);
            border-radius: 15px; padding: 15px; color: #fff;
            box-sizing: border-box; outline: none; font-family: 'Tajawal';
            font-size: 16px; transition: 0.3s;
        }
        input:focus { border-color: var(--gold); }

        .price-display-box {
            background: #121212; border-radius: 20px; padding: 20px;
            text-align: center; margin: 25px 0; border: 1px solid #1f1f1f;
        }

        .price-display-box h2 {
            margin: 10px 0 0 0; font-size: 32px; font-weight: 900;
            background: var(--gold-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .submit-btn {
            width: 100%; padding: 20px; background: var(--gold-grad);
            border: none; border-radius: 20px; font-size: 20px;
            font-weight: 900; color: #000; cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.4);
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        #adminPanel {
            display: none; position: fixed; inset: 0;
            background: #000; z-index: 9999; overflow-y: auto; padding: 20px;
        }

        .admin-card {
            background: #0c0c0c; border: 1px solid var(--gold);
            border-radius: 30px; padding: 25px; max-width: 550px; margin: auto;
        }

        .admin-sec {
            border-bottom: 1px solid #222; padding-bottom: 20px; margin-bottom: 20px;
        }

        .admin-sec h4 { color: var(--gold); margin-top: 0; }

        .vip-row { display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px; margin-bottom: 10px; }

        .loader {
            border: 3px solid #f3f3f3; border-top: 3px solid var(--gold);
            border-radius: 50%; width: 18px; height: 18px;
            animation: spin 1s linear infinite; display: inline-block;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="master-brand">HELMY CARD</div>

<div id="noApps" style="display:none; text-align:center; border:1px solid var(--gold); padding:40px; border-radius:30px;">
    <h3>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø­Ù„Ù…ÙŠ ÙƒØ§Ø±Ø¯</h3>
    <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±Ø§Ù…Ø¬ Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø§ÙØªØ­ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø¨Ø±Ù†Ø§Ù…Ø¬.</p>
    <button onclick="openAdmin()" class="submit-btn" style="width:auto; padding:15px 40px;">ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… âš™ï¸</button>
</div>

<div class="tabs-container" id="tabsList"></div>

<div class="main-card" id="userUI">
    <div class="app-name-ui" id="ui_app_name" onclick="openAdmin()"></div>

    <div class="withdraw-info" onclick="copyId()">
        <small style="color:#888;">ID Ø§Ù„Ø³Ø­Ø¨ (Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®)</small><br>
        <b id="ui_withdraw_id" style="font-size: 24px; color: var(--gold);"></b><br>
        <span id="ui_receiver_name" style="color:#eee;"></span>
    </div>

    <div class="input-group">
        <label>ID Ø§Ù„Ø­Ø³Ø§Ø¨ (Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ù…Ù†Ù‡)</label>
        <input type="text" id="in_uid" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£ÙŠØ¯ÙŠ Ù‡Ù†Ø§">
    </div>

    <div class="input-group">
        <label>Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„</label>
        <input type="text" id="in_agent_name">
    </div>

    <div class="input-group">
        <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø­Ø¨</label>
        <select id="in_method" onchange="calc()">
            <option value="cash">ÙƒØ§Ø´ (ÙÙˆØ¯Ø§ÙÙˆÙ†/Ø§ØªØµØ§Ù„Ø§Øª/Ø£ÙˆØ±Ù†Ø¬)</option>
            <option value="agent">Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…ÙˆØ­Ø¯</option>
            <option value="vip">ÙˆÙƒÙŠÙ„ Ù…Ø®ØµØµ VIP ğŸ’</option>
        </select>
    </div>

    <div id="vip_box" class="input-group" style="display:none;">
        <label>Ø§Ø®ØªØ± Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø®ØµØµ</label>
        <select id="in_vip_list" onchange="calc()"></select>
    </div>

    <div class="input-group">
        <label id="lbl_amount">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
        <input type="number" id="in_val" value="0" step="0.01" oninput="calc()">
        <div id="points_hint" style="font-size:12px; color:var(--gold); margin-top:5px; display:none;"></div>
    </div>

    <div class="price-display-box">
        <small id="ui_usd_val" style="color:#888; display:block; margin-bottom:5px;"></small>
        <small id="ui_rate"></small>
        <h2 id="ui_total">0.00 Ø¬.Ù…</h2>
    </div>

    <div class="input-group"><label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø­ÙØ¸Ø©</label><input type="text" id="in_wallet" placeholder="01xxxxxxxxx"></div>
    <div class="input-group"><label>ØµÙˆØ±Ø© Ø¥Ø«Ø¨Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„</label><input type="file" id="in_file" accept="image/*"></div>

    <button class="submit-btn" id="btnSubmit" onclick="sendOrder()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€</button>
</div>

<div id="adminPanel">
    <div class="admin-card">
        <h2 style="text-align:center; color:var(--gold);">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
        
        <div class="admin-sec">
            <h4>â• Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù†Ø§Ù…Ø¬</h4>
            <div style="display:flex; gap:10px;">
                <input type="text" id="new_app_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬">
                <button onclick="createApp()" style="background:#28a745; color:#fff; border:none; padding:10px 20px; border-radius:15px; cursor:pointer;">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>

        <div id="editZone" style="display:none;">
            <div class="admin-sec">
                <h4>ğŸ›¡ï¸ Ù†ÙˆØ¹ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆÙ…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±</h4>
                <label>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„Ø©:</label>
                <select id="adm_mode" onchange="toggleAdminPoints()">
                    <option value="usd">Ø¯ÙˆÙ„Ø§Ø± Ù…Ø¨Ø§Ø´Ø± ($)</option>
                    <option value="points">Ù†Ù‚Ø§Ø· Ù…Ø­ÙˆÙ„Ø© (Points)</option>
                </select>
                <div id="adm_points_cfg" style="display:none; margin-top:10px; background:#1a1a1a; padding:10px; border-radius:10px;">
                    <label>ÙƒÙ„ ÙƒÙ… Ù†Ù‚Ø·Ø©ØŸ</label>
                    <input type="number" id="adm_pt_count" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1000">
                    <label>ÙŠØ³Ø§ÙˆÙŠ ÙƒÙ… Ø¯ÙˆÙ„Ø§Ø±ØŸ</label>
                    <input type="number" id="adm_pt_usd" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1">
                </div>
                <label style="margin-top:10px;">Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± (Ø£ÙŠØ§Ù…):</label>
                <input type="number" id="adm_anti" placeholder="0 = Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø¹">
            </div>

            <div class="admin-sec">
                <h4>ğŸ”— Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                <label>Script URL</label><input type="text" id="adm_sheet">
                <label>Bot Token</label><input type="text" id="adm_token">
                <label>Chat ID</label><input type="text" id="adm_chat">
                <label>ID Ø§Ù„Ø³Ø­Ø¨</label><input type="text" id="adm_wid">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</label><input type="text" id="adm_rec">
            </div>

            <div class="admin-sec">
                <h4>ğŸ’° Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±</h4>
                <label>Ø³Ø¹Ø± Ø§Ù„ÙƒØ§Ø´</label><input type="number" id="adm_r_cash">
                <label>Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡</label><input type="number" id="adm_r_agent">
            </div>

            <div class="admin-sec">
                <h4>ğŸ’ ÙˆÙƒÙ„Ø§Ø¡ VIP</h4>
                <div id="adm_vip_list"></div>
                <button onclick="addVRow()" style="width:100%; padding:10px; margin-top:10px; background:#333; color:#fff; border:none; border-radius:10px;">+ Ø¥Ø¶Ø§ÙØ© ÙˆÙƒÙŠÙ„ VIP</button>
            </div>

            <button class="submit-btn" onclick="save()">âœ… Ø­ÙØ¸ ÙƒÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            <button onclick="deleteApp()" style="background:red; color:#fff; width:100%; margin-top:10px; border:none; padding:12px; border-radius:15px; cursor:pointer;">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</button>
        </div>
        <button onclick="document.getElementById('adminPanel').style.display='none'" style="width:100%; margin-top:15px; background:#222; color:#fff; border:none; padding:12px; border-radius:15px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script>
    // Firebase Config
    const firebaseConfig = { databaseURL: "https://karak-13101-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let allApps = {};
    let currentKey = "";
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxfFvTfYyMOw5NZOZfDq1WwvW85BT_yM8uwa_i67mapybcCAbZrTOYZ0nS_S_HtCjQ9QQ/exec";

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    db.ref('Helmy_Final_Ultimate').on('value', (s) => {
        allApps = s.val() || {};
        const keys = Object.keys(allApps);
        if (keys.length === 0) {
            document.getElementById('noApps').style.display = "block";
            document.getElementById('userUI').style.display = "none";
        } else {
            document.getElementById('noApps').style.display = "none";
            document.getElementById('userUI').style.display = "block";
            renderTabs();
            if (!currentKey || !allApps[currentKey]) loadApp(keys[0]);
            else loadApp(currentKey);
        }
    });

    function renderTabs() {
        const h = document.getElementById('tabsList'); h.innerHTML = "";
        for (let k in allApps) {
            let b = document.createElement('button');
            b.className = `tab-btn ${k === currentKey ? 'active' : ''}`;
            b.innerText = k; b.onclick = () => loadApp(k); h.appendChild(b);
        }
    }

    function loadApp(k) {
        currentKey = k; const d = allApps[k];
        document.getElementById('ui_app_name').innerText = k;
        document.getElementById('ui_withdraw_id').innerText = d.withdraw_id || "---";
        document.getElementById('ui_receiver_name').innerText = d.receiver_name || "";
        
        // Ø¶Ø¨Ø· Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø­Ø³Ø¨ (Ø¯ÙˆÙ„Ø§Ø± Ø£Ù… Ù†Ù‚Ø§Ø·)
        if(d.mode === "points") {
            document.getElementById('lbl_amount').innerText = "Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ø§Ù„Ù†Ù‚Ø§Ø· (P)";
            document.getElementById('points_hint').style.display = "block";
            document.getElementById('points_hint').innerText = `ÙƒÙ„ ${d.pt_count} Ù†Ù‚Ø·Ø© = ${d.pt_usd}$`;
        } else {
            document.getElementById('lbl_amount').innerText = "Ø§Ù„ÙƒÙ…ÙŠØ© Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± ($)";
            document.getElementById('points_hint').style.display = "none";
        }

        renderTabs();
        calc();
    }

    function calc() {
        const d = allApps[currentKey]; if(!d) return;
        const method = document.getElementById('in_method').value;
        const inputVal = parseFloat(document.getElementById('in_val').value) || 0;
        let usdVal = inputVal;

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ø¯ÙˆÙ„Ø§Ø± Ù„Ùˆ Ø§Ù„Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø·
        if(d.mode === "points" && d.pt_count > 0) {
            usdVal = (inputVal / d.pt_count) * d.pt_usd;
            document.getElementById('ui_usd_val').innerText = `Ù…Ø§ ÙŠØ¹Ø§Ø¯Ù„: ${usdVal.toFixed(2)}$`;
        } else {
            document.getElementById('ui_usd_val').innerText = "";
        }

        let rate = 0;
        document.getElementById('vip_box').style.display = (method === "vip") ? "block" : "none";

        if (method === "cash") rate = d.rate_cash || 0;
        else if (method === "agent") rate = d.rate_agent || 0;
        else if (method === "vip") {
            const vUi = document.getElementById('in_vip_list');
            if (vUi.dataset.app !== currentKey) {
                vUi.innerHTML = "";
                if(d.vips) d.vips.forEach(v => {
                    let o = document.createElement('option'); o.value = v.price; o.text = `${v.code} (${v.price})`; vUi.add(o);
                });
                vUi.dataset.app = currentKey;
            }
            rate = parseFloat(vUi.value) || 0;
        }

        document.getElementById('ui_rate').innerText = "Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±: " + rate;
        document.getElementById('ui_total').innerText = (usdVal * rate).toFixed(2) + " Ø¬.Ù…";
    }

    function openAdmin() { if(prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:") === "1997") { document.getElementById('adminPanel').style.display = "block"; if(currentKey) loadAdmin(); } }

    function loadAdmin() {
        const d = allApps[currentKey];
        document.getElementById('editZone').style.display = "block";
        document.getElementById('adm_sheet').value = d.sheet_link || SCRIPT_URL;
        document.getElementById('adm_token').value = d.bot_token || "";
        document.getElementById('adm_chat').value = d.chat_id || "";
        document.getElementById('adm_wid').value = d.withdraw_id || "";
        document.getElementById('adm_rec').value = d.receiver_name || "";
        document.getElementById('adm_r_cash').value = d.rate_cash || "";
        document.getElementById('adm_r_agent').value = d.rate_agent || "";
        document.getElementById('adm_anti').value = d.anti_repeat || 0;
        document.getElementById('adm_mode').value = d.mode || "usd";
        document.getElementById('adm_pt_count').value = d.pt_count || 1000;
        document.getElementById('adm_pt_usd').value = d.pt_usd || 1;
        toggleAdminPoints();
        const l = document.getElementById('adm_vip_list'); l.innerHTML = "";
        if(d.vips) d.vips.forEach(v => addVRow(v.code, v.price));
    }

    function toggleAdminPoints() {
        document.getElementById('adm_points_cfg').style.display = (document.getElementById('adm_mode').value === "points") ? "block" : "none";
    }

    function addVRow(c="", p="") {
        const div = document.createElement('div'); div.className="vip-row";
        div.innerHTML = `<input type="text" placeholder="ÙƒÙˆØ¯" value="${c}" class="vc"><input type="number" placeholder="Ø³Ø¹Ø±" value="${p}" class="vp"><button onclick="this.parentElement.remove()" style="background:red; border:none; color:#fff; border-radius:10px;">X</button>`;
        document.getElementById('adm_vip_list').appendChild(div);
    }

    function createApp() {
        const n = document.getElementById('new_app_name').value; if(!n) return;
        db.ref('Helmy_Final_Ultimate/' + n).set({ mode: "usd", rate_cash: 45, rate_agent: 46.5, sheet_link: SCRIPT_URL });
        document.getElementById('new_app_name').value = "";
    }

    function save() {
        const vips = [];
        document.querySelectorAll('.vip-row').forEach(r => {
            let c = r.querySelector('.vc').value; let p = r.querySelector('.vp').value;
            if(c && p) vips.push({code: c, price: p});
        });
        db.ref('Helmy_Final_Ultimate/' + currentKey).update({
            sheet_link: document.getElementById('adm_sheet').value,
            bot_token: document.getElementById('adm_token').value,
            chat_id: document.getElementById('adm_chat').value,
            withdraw_id: document.getElementById('adm_wid').value,
            receiver_name: document.getElementById('adm_rec').value,
            rate_cash: parseFloat(document.getElementById('adm_r_cash').value),
            rate_agent: parseFloat(document.getElementById('adm_r_agent').value),
            anti_repeat: parseInt(document.getElementById('adm_anti').value) || 0,
            mode: document.getElementById('adm_mode').value,
            pt_count: parseFloat(document.getElementById('adm_pt_count').value),
            pt_usd: parseFloat(document.getElementById('adm_pt_usd').value),
            vips: vips
        }).then(() => alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…"));
    }

    async function sendOrder() {
        const d = allApps[currentKey];
        const f = document.getElementById('in_file').files[0];
        const uid = document.getElementById('in_uid').value.trim();
        const val = document.getElementById('in_val').value;
        const wal = document.getElementById('in_wallet').value;
        const btn = document.getElementById('btnSubmit');

        if(!f || !uid || !wal || val <= 0) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");

        btn.disabled = true;
        btn.innerHTML = `<span class="loader"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...`;

        // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
        if (d.anti_repeat > 0) {
            try {
                const check = await fetch(`${d.sheet_link}?checkId=${uid}&days=${d.anti_repeat}&sheet=${currentKey}`);
                const res = await check.text();
                if (res === "EXISTS") {
                    alert(`âŒ Ù‡Ø°Ø§ Ø§Ù„Ø£ÙŠØ¯ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ø®Ù„Ø§Ù„ Ø§Ù„Ù€ ${d.anti_repeat} Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø§Ø¶ÙŠØ©.`);
                    btn.disabled = false; btn.innerHTML = "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€";
                    return;
                }
            } catch (e) { }
        }

        // Telegram
        const fd = new FormData();
        fd.append('chat_id', d.chat_id); fd.append('photo', f);
        fd.append('caption', `ğŸ“¦ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬: ${currentKey}\nğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: ${uid}\nğŸ‘¤ Ø§Ù„ÙˆÙƒÙŠÙ„: ${document.getElementById('in_agent_name').value}\nğŸ’° Ø§Ù„ÙƒÙ…ÙŠØ©: ${val} (${d.mode})\nğŸ’µ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('ui_total').innerText}\nğŸ¦ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${wal}`);
        fetch(`https://api.telegram.org/bot${d.bot_token}/sendPhoto`, { method: 'POST', body: fd });

        // Sheets
        fetch(d.sheet_link, {
            method: 'POST', mode: 'no-cors',
            body: JSON.stringify({
                programName: currentKey, uid: uid, agent: document.getElementById('in_agent_name').value,
                usd: val, totalEgp: document.getElementById('ui_total').innerText, wallet: wal,
                day: ["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"][(new Date()).getDay()],
                date: (new Date()).toLocaleDateString('ar-EG')
            })
        });

        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! âœ…"); location.reload();
    }

    function copyId() { navigator.clipboard.writeText(document.getElementById('ui_withdraw_id').innerText); alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø£ÙŠØ¯ÙŠ âœ…"); }
    function deleteApp() { if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ØŸ")) db.ref('Helmy_Final_Ultimate/' + currentKey).remove(); }
</script>
</body>
</html>
