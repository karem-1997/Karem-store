<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helmy Card - Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        
        :root {
            --gold: #bf953f;
            --gold-gradient: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --bg-color: #0c0c0c;
            --card-bg: #141414;
            --input-bg: #1a1a1a;
            --border-color: #333;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            color: #fff;
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ØªØ§Ø¨Ø§Øª (Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬) */
        .tabs-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            width: 100%;
            max-width: 450px;
            padding: 10px 0;
        }

        .tab-btn {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: #888;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
        }

        .tab-btn.active {
            background: var(--gold-gradient);
            color: #000;
            font-weight: bold;
            border: none;
        }

        /* Ø§Ù„ÙƒØ§Ø±Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ø²ÙŠ Ø§Ù„ØµÙˆØ±Ø©) */
        .main-container {
            width: 100%;
            max-width: 450px;
            border: 2px solid var(--gold);
            border-radius: 30px;
            padding: 20px;
            background: var(--bg-color);
            box-sizing: border-box;
            display: none; /* ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        }

        .site-title {
            text-align: center;
            font-size: 28px;
            font-weight: 900;
            background: var(--gold-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .warning-text {
            color: #ff4d4d;
            text-align: center;
            font-size: 13px;
            margin-bottom: 20px;
        }

        .withdraw-info-box {
            border: 1px dashed var(--gold);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            color: var(--gold);
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            color: #fff;
            box-sizing: border-box;
            outline: none;
            font-family: 'Tajawal';
        }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ */
        .total-box {
            background: #111;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            margin: 20px 0;
            border: 1px solid #222;
        }

        .total-box small { color: var(--gold); font-size: 12px; }
        .total-box h2 { margin: 5px 0; font-size: 26px; }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: var(--gold-gradient);
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #000;
            cursor: pointer;
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø²ÙŠ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù„ÙŠ Ø¨Ø¹ØªÙ‡Ø§) */
        #adminPanel {
            display: none;
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 1000;
            overflow-y: auto;
            padding: 15px;
        }

        .admin-content {
            background: #0c0c0c;
            border: 1px solid var(--gold);
            border-radius: 20px;
            padding: 20px;
            max-width: 500px;
            margin: auto;
        }

        .admin-section {
            border-bottom: 1px solid #222;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }

        .admin-section h4 { color: var(--gold); margin-bottom: 10px; }

        .vip-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 5px;
            margin-bottom: 10px;
        }

        .btn-delete { background: #ff4d4d; border: none; padding: 5px 10px; border-radius: 5px; color: #fff; }
        .btn-add-vip { background: #28a745; color: #fff; border: none; width: 100%; padding: 10px; border-radius: 10px; margin-top: 10px; }
        .btn-save { background: var(--gold-gradient); color: #000; font-weight: bold; border: none; width: 100%; padding: 15px; border-radius: 15px; margin-top: 20px; }

    </style>
</head>
<body>

<div class="tabs-container" id="tabsList"></div>

<div class="main-container" id="userUI">
    <h1 class="site-title" id="ui_site_title" onclick="openAdmin()">Helmy Card</h1>
    <p class="warning-text" id="ui_warning"></p>

    <div class="withdraw-info-box" onclick="copyWithdrawID()">
        <span style="font-size: 13px;">ID Ø³Ø­Ø¨: <b id="ui_withdraw_id"></b></span><br>
        <span style="font-size: 13px;">Ø§Ù„Ø§Ø³Ù…: <b id="ui_receiver_name"></b></span><br>
        <small style="color: #888;">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù†Ø³Ø® Ø§Ù„Ø£ÙŠØ¯ÙŠ ğŸ‘‡</small>
    </div>

    <div class="input-group">
        <label id="lbl_id_field"></label>
        <input type="text" id="in_uid" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ø±Ù Ù‡Ù†Ø§">
    </div>

    <div class="input-group">
        <label id="lbl_agent_field">Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„</label>
        <input type="text" id="in_agent_name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    </div>

    <div class="input-group">
        <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
        <select id="in_method" onchange="updateCalculations()">
            <option value="cash">ÙÙˆØ¯Ø§ÙÙˆÙ† / Ø§ØªØµØ§Ù„Ø§Øª / Ø£ÙˆØ±Ù†Ø¬ ÙƒØ§Ø´</option>
            <option value="agent">Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù…ÙˆØ­Ø¯</option>
            <option value="vip">ÙˆÙƒÙŠÙ„ Ù…Ø®ØµØµ (VIP)</option>
        </select>
    </div>

    <div id="vip_selection_div" class="input-group" style="display:none;">
        <label>Ø§Ø®ØªØ± ÙƒÙˆØ¯ Ø§Ù„ÙˆÙƒÙŠÙ„</label>
        <select id="in_vip_list" onchange="updateCalculations()"></select>
    </div>

    <div class="input-group">
        <label id="lbl_amount_field">Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± ($)</label>
        <input type="number" id="in_usd" value="0.00" step="0.01" oninput="updateCalculations()">
    </div>

    <div class="total-box">
        <small id="ui_rate_display"></small>
        <h2 id="ui_total_egp">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0.00 Ø¬.Ù…</h2>
    </div>

    <div class="input-group">
        <label>Ø±Ù‚Ù… Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label>
        <input type="text" id="in_wallet" placeholder="01xxxxxxxxx">
    </div>

    <div class="input-group">
        <label>ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„</label>
        <input type="file" id="in_file" accept="image/*">
    </div>

    <button class="submit-btn" onclick="submitOrder()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€</button>
</div>

<div id="adminPanel">
    <div class="admin-content">
        <h2 style="text-align:center; color: var(--gold);">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h2>
        
        <div class="admin-section">
            <h4>â• Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯</h4>
            <div style="display:flex; gap:5px;">
                <input type="text" id="new_app_name" placeholder="Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚">
                <button onclick="createNewApp()" class="btn-add-vip" style="margin:0; width:80px;">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>

        <div id="editFields" style="display:none;">
            <div class="admin-section">
                <h4>ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø±Ø¨Ø·</h4>
                <label>Ø±Ø§Ø¨Ø· Google Script</label>
                <input type="text" id="adm_sheet" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥ÙƒØ³Ù„">
                <label>ØªÙˆÙƒÙ† Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…</label>
                <input type="text" id="adm_token">
                <label>Chat ID</label>
                <input type="text" id="adm_chat">
            </div>

            <div class="admin-section">
                <h4>ğŸ·ï¸ Ù…Ø³Ù…ÙŠØ§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h4>
                <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
                <input type="text" id="adm_site_title">
                <label>Ù†Øµ Ø§Ù„ØªØ­Ø°ÙŠØ±</label>
                <input type="text" id="adm_warning">
                <label>ID Ø§Ù„Ø³Ø­Ø¨</label>
                <input type="text" id="adm_withdraw_id">
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</label>
                <input type="text" id="adm_receiver_name">
                <label>Ø§Ø³Ù… Ø®Ø§Ù†Ø© ID Ø§Ù„Ø­Ø³Ø§Ø¨</label>
                <input type="text" id="adm_lbl_id">
            </div>

            <div class="admin-section">
                <h4>ğŸ’° Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h4>
                <label>Ø³Ø¹Ø± Ø§Ù„ÙƒØ§Ø´ Ø§Ù„Ø¹Ø§Ù…</label>
                <input type="number" step="0.1" id="adm_rate_cash">
                <label>Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù…ÙˆØ­Ø¯</label>
                <input type="number" step="0.1" id="adm_rate_agent">
            </div>

            <div class="admin-section">
                <h4>ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù…Ø®ØµØµÙŠÙ† (ÙƒÙˆØ¯ ÙˆØ³Ø¹Ø±)</h4>
                <div id="adm_vip_list"></div>
                <button class="btn-add-vip" onclick="addVipRow()">+ Ø¥Ø¶Ø§ÙØ© ÙˆÙƒÙŠÙ„ Ù…Ø®ØµØµ</button>
            </div>

            <button class="btn-save" onclick="saveSettings()">âœ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØªØ·Ø¨ÙŠÙ‚Ù‡Ø§</button>
            <button onclick="deleteCurrentApp()" style="background:red; width:100%; margin-top:10px;" class="btn-save">ğŸ—‘ï¸ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
        </div>
        <button onclick="document.getElementById('adminPanel').style.display='none'" class="btn-save" style="background:#333;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Firebase (Ø§Ø³ØªØ®Ø¯Ù… Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§)
    const firebaseConfig = { databaseURL: "https://karak-13101-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let allApps = {};
    let currentAppKey = "";

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    db.ref('HelmyMasterV3').on('value', (snapshot) => {
        allApps = snapshot.val() || {};
        renderTabs();
        if (currentAppKey && allApps[currentAppKey]) {
            loadAppData(currentAppKey);
        } else if (Object.keys(allApps).length > 0) {
            loadAppData(Object.keys(allApps)[0]);
        }
    });

    function renderTabs() {
        const container = document.getElementById('tabsList');
        container.innerHTML = "";
        for (let key in allApps) {
            let btn = document.createElement('button');
            btn.className = `tab-btn ${key === currentAppKey ? 'active' : ''}`;
            btn.innerText = key;
            btn.onclick = () => loadAppData(key);
            container.appendChild(btn);
        }
    }

    function loadAppData(key) {
        currentAppKey = key;
        const data = allApps[key];
        document.getElementById('userUI').style.display = "block";
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.getElementById('ui_site_title').innerText = data.site_title || "Helmy Card";
        document.getElementById('ui_warning').innerText = data.warning || "";
        document.getElementById('ui_withdraw_id').innerText = data.withdraw_id || "";
        document.getElementById('ui_receiver_name').innerText = data.receiver_name || "";
        document.getElementById('lbl_id_field').innerText = data.lbl_id || "ID Ø§Ù„Ø­Ø³Ø§Ø¨";
        
        renderTabs();
        updateCalculations();
    }

    function updateCalculations() {
        const data = allApps[currentAppKey];
        if (!data) return;

        const method = document.getElementById('in_method').value;
        const usd = parseFloat(document.getElementById('in_usd').value) || 0;
        let rate = 0;

        document.getElementById('vip_selection_div').style.display = (method === "vip") ? "block" : "none";

        if (method === "cash") {
            rate = data.rate_cash || 0;
        } else if (method === "agent") {
            rate = data.rate_agent || 0;
        } else if (method === "vip") {
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ VIP ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
            const vipListUi = document.getElementById('in_vip_list');
            if (vipListUi.options.length === 0 || vipListUi.dataset.app !== currentAppKey) {
                vipListUi.innerHTML = "";
                if (data.vips) {
                    for (let vk in data.vips) {
                        let opt = document.createElement('option');
                        opt.value = data.vips[vk].price;
                        opt.innerText = `ÙƒÙˆØ¯: ${data.vips[vk].code} (Ø³Ø¹Ø±: ${data.vips[vk].price})`;
                        vipListUi.appendChild(opt);
                    }
                }
                vipListUi.dataset.app = currentAppKey;
            }
            rate = parseFloat(vipListUi.value) || 0;
        }

        document.getElementById('ui_rate_display').innerText = `Ø³Ø¹Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„: ${rate}`;
        document.getElementById('ui_total_egp').innerText = `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${(usd * rate).toFixed(2)} Ø¬.Ù…`;
    }

    // ÙˆØ¸Ø§Ø¦Ù Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    function openAdmin() {
        let pass = prompt("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:");
        if (pass === "1997") {
            document.getElementById('adminPanel').style.display = "block";
            loadAdminFields();
        }
    }

    function loadAdminFields() {
        if (!currentAppKey) return;
        const data = allApps[currentAppKey];
        document.getElementById('editFields').style.display = "block";
        document.getElementById('adm_sheet').value = data.sheet_link || "";
        document.getElementById('adm_token').value = data.bot_token || "";
        document.getElementById('adm_chat').value = data.chat_id || "";
        document.getElementById('adm_site_title').value = data.site_title || "";
        document.getElementById('adm_warning').value = data.warning || "";
        document.getElementById('adm_withdraw_id').value = data.withdraw_id || "";
        document.getElementById('adm_receiver_name').value = data.receiver_name || "";
        document.getElementById('adm_lbl_id').value = data.lbl_id || "";
        document.getElementById('adm_rate_cash').value = data.rate_cash || "";
        document.getElementById('adm_rate_agent').value = data.rate_agent || "";

        const vipContainer = document.getElementById('adm_vip_list');
        vipContainer.innerHTML = "";
        if (data.vips) {
            for (let vk in data.vips) {
                addVipRow(data.vips[vk].code, data.vips[vk].price);
            }
        }
    }

    function addVipRow(code = "", price = "") {
        const div = document.createElement('div');
        div.className = "vip-row";
        div.innerHTML = `
            <input type="text" placeholder="Ø§Ù„ÙƒÙˆØ¯" value="${code}" class="v-code">
            <input type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±" value="${price}" class="v-price">
            <button class="btn-delete" onclick="this.parentElement.remove()">ğŸ—‘ï¸</button>
        `;
        document.getElementById('adm_vip_list').appendChild(div);
    }

    function createNewApp() {
        const name = document.getElementById('new_app_name').value;
        if (!name) return;
        db.ref('HelmyMasterV3/' + name).set({
            site_title: "Helmy Card",
            rate_cash: 45,
            rate_agent: 46.5,
            lbl_id: "Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ù…Ù†Ù‡"
        });
        document.getElementById('new_app_name').value = "";
    }

    function saveSettings() {
        const vips = [];
        document.querySelectorAll('.vip-row').forEach(row => {
            vips.push({
                code: row.querySelector('.v-code').value,
                price: row.querySelector('.v-price').value
            });
        });

        const updatedData = {
            sheet_link: document.getElementById('adm_sheet').value,
            bot_token: document.getElementById('adm_token').value,
            chat_id: document.getElementById('adm_chat').value,
            site_title: document.getElementById('adm_site_title').value,
            warning: document.getElementById('adm_warning').value,
            withdraw_id: document.getElementById('adm_withdraw_id').value,
            receiver_name: document.getElementById('adm_receiver_name').value,
            lbl_id: document.getElementById('adm_lbl_id').value,
            rate_cash: parseFloat(document.getElementById('adm_rate_cash').value),
            rate_agent: parseFloat(document.getElementById('adm_rate_agent').value),
            vips: vips
        };

        db.ref('HelmyMasterV3/' + currentAppKey).update(updatedData).then(() => {
            alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!");
            document.getElementById('in_vip_list').dataset.app = ""; // Ù„Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠØ«
        });
    }

    function deleteCurrentApp() {
        if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ")) {
            db.ref('HelmyMasterV3/' + currentAppKey).remove();
            currentAppKey = "";
        }
    }

    function copyWithdrawID() {
        const id = document.getElementById('ui_withdraw_id').innerText;
        navigator.clipboard.writeText(id);
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø£ÙŠØ¯ÙŠ: " + id);
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ (ØªÙ„ÙŠØ¬Ø±Ø§Ù… + Ø¥ÙƒØ³Ù„)
    async function submitOrder() {
        const data = allApps[currentAppKey];
        const file = document.getElementById('in_file').files[0];
        const uid = document.getElementById('in_uid').value;
        const agent = document.getElementById('in_agent_name').value;
        const usd = document.getElementById('in_usd').value;
        const wallet = document.getElementById('in_wallet').value;
        const total = document.getElementById('ui_total_egp').innerText;

        if (!uid || !usd || !wallet || !file) {
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ ÙƒØ§ÙØ© Ø§Ù„Ø®Ø§Ù†Ø§Øª ÙˆØ§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©!");
            return;
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        const formData = new FormData();
        formData.append('chat_id', data.chat_id);
        formData.append('photo', file);
        formData.append('caption', `ğŸ“¦ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯: ${currentAppKey}\nğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: ${uid}\nğŸ‘¤ Ø§Ù„ÙˆÙƒÙŠÙ„: ${agent}\nğŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº: ${usd}$\nğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total}\nğŸ¦ Ø§Ù„Ù…Ø­ÙØ¸Ø©: ${wallet}`);

        fetch(`https://api.telegram.org/bot${data.bot_token}/sendPhoto`, {
            method: 'POST',
            body: formData
        });

        // Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª
        fetch(data.sheet_link, {
            method: 'POST',
            body: JSON.stringify({
                data: [{
                    "Ø§Ù„Ø£ÙŠØ¯ÙŠ": uid,
                    "Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„": agent,
                    "Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±": usd,
                    "Ø§Ù„Ù…ØµØ±ÙŠ": total,
                    "Ø§Ù„Ù…Ø­ÙØ¸Ø©": wallet,
                    "Ø§Ù„ØªØ§Ø±ÙŠØ®": new Date().toLocaleString('ar-EG')
                }]
            })
        });

        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!");
        location.reload();
    }
</script>

</body>
</html>
